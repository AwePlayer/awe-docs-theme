---
import Search from "../SearchDialog";
import themeConfig from "../../../theme.config";
---

<div
  class="w-80 sticky top-14 hidden lg:flex flex-col items-center h-[calc(100vh-56px)] border-r dark:border-zinc-800/60"
>
  <nav class="w-full h-full flex flex-col justify-between relative">
    <div class="w-full h-full overflow-hidden">
      <div
        class="p-4 absolute top-0 left-0 right-0 backdrop-blur-xl w-full z-[1]"
      >
        <Search client:load />
      </div>
      <ul
        class="nav-groups p-4 w-full h-full overflow-y-scroll pt-20 pb-10 no-scrollbar"
      >
        {
          themeConfig.sidebar?.map((item) => (
            <div class="text-zinc-600 group z-0">
              <a
                href={themeConfig.baseUrl + item.href}
                class="py-1 flex items-center hover:text-indigo-500 dark:hover:text-indigo-200 space-x-2"
              >
                {item.children && (
                  <svg
                    class="rotate-90 text-zinc-700 group-hover:text-indigo-500 dark:group-hover:text-indigo-200"
                    width="18"
                    height="18"
                    stroke-width="1.5"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M9 6L15 12L9 18"
                      stroke="currentColor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                )}
                <span
                  class={
                    !item.children
                      ? "text-sm px-2"
                      : "text-lg text-zinc-500 group-hover:text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-purple-500 dark:from-blue-200 dark:to-purple-200"
                  }
                >
                  {item.title}
                </span>
              </a>
              <ul class="border-l ml-2 pl-5 dark:border-zinc-700 group-hover:border-indigo-500 dark:group-hover:border-indigo-200">
                {item.children?.map((item) => (
                  <a
                    class="hover:text-indigo-500 dark:hover:text-indigo-200"
                    href={themeConfig.baseUrl + item.href}
                  >
                    <li class="py-1 text-sm">{item.title}</li>
                  </a>
                ))}
              </ul>
            </div>
          ))
        }
      </ul>
    </div>
  </nav>
</div>

<script is:inline>
{
  const leftSidebar = document.querySelector(".nav-groups");
  const leftSidebarScroll = localStorage.getItem("sidebar-scroll");
  if (leftSidebarScroll !== null) {
    leftSidebar.scrollTop = parseInt(leftSidebarScroll, 10);
  }
  window.addEventListener("beforeunload", () => {
    localStorage.setItem("sidebar-scroll", leftSidebar.scrollTop);
  });
}
</script>

<style>
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }
  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
</style>
